# =============================================================================
# Monorepo GitRepository and Kustomization for FluxCD
# =============================================================================
# This configures FluxCD to sync application deployments from the monorepo.
# The monorepo contains nginx.local, handbooks.local, and other applications.
# =============================================================================
apiVersion: source.toolkit.fluxcd.io/v1
kind: GitRepository
metadata:
  name: monorepo
  namespace: flux-system
spec:
  interval: 1m
  url: https://github.com/panicboat/monorepo.git
  ref:
    # TODO: (k3d) Change branch for different environments
    branch: main
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: monorepo
  namespace: flux-system
spec:
  interval: 10m0s
  path: ./clusters/develop
  prune: true
  sourceRef:
    kind: GitRepository
    name: monorepo
